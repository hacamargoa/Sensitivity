stat_summary(fun = mean, geom = "point", shape=16, size=1,position=position_dodge(1))+
stat_boxplot(geom = "errorbar", width = 0.2) +
labs(title="",x="", y = ifelse(i==1|i==5,"Yield difference",""))
temp <- Maize_best[Maize_best$Clust=="1",] %>% group_by(Parm = factor(eval(parse(text=names(Maize_best)[i+1])))) %>%
summarise(Count = length(eval(parse(text=names(Maize_best)[i+1]))))
d=dim(temp)[1]
b1<-ggplot(Maize_best[Maize_best$Clust=="1",], aes(x=as.factor(eval(parse(text=names(Maize_best)[i+1])))))+
geom_bar(color="black",fill="orange",alpha=0.2)+ylim(c(0,max(temp$Count)+5))+ylim(c(0,max(temp$Count)+5))+
theme(plot.margin=unit(c(-0.5,-0.1,-0.6,0), "cm"),axis.ticks.y = element_blank(),
axis.title.y = element_text(margin = margin(t = 0, r = 12, b = 0, l = 0)),
axis.title=element_text(size=12,face="bold"),axis.text=element_text(size=12,face="bold"))+
geom_text(stat='count', aes(label=paste0("n=",..count..)), y=max(temp$Count)+5,size=ifelse(d>4,2.8,ifelse(d==4,3.5,4)))+
labs(title=" ",x="", y = ifelse(i==1|i==5,"Number of simulations",""))
g2<-ggplot(Maize_best[Maize_best$Clust=="2",], aes(x=as.factor(eval(parse(text=names(Maize_best)[i+1]))), y=Diff))+
geom_boxplot(fill="green",alpha=0.2)+ylim(c(0.19,0.32))+
theme(legend.position = "none",plot.margin=unit(c(-0.4,0,-0.3,0.2),"cm"), axis.text.y = element_blank(), axis.text.x = element_blank(),
axis.ticks.y = element_blank(),axis.title=element_text(size=10,face="bold"),axis.text=element_text(size=12,face="bold"),
axis.ticks.x = element_blank())+
stat_summary(fun = mean, geom = "point", shape=16, size=1,position=position_dodge(1))+
stat_boxplot(geom = "errorbar", width = 0.2) +
labs(title=" ",x="", y = "")
temp <- Maize_best[Maize_best$Clust=="2",] %>% group_by(Parm = factor(eval(parse(text=names(Maize_best)[i+1])))) %>%
summarise(Count = length(eval(parse(text=names(Maize_best)[i+1]))))
d=dim(temp)[1]
b2<-ggplot(Maize_best[Maize_best$Clust=="2",], aes(x=as.factor(eval(parse(text=names(Maize_best)[i+1])))))+
geom_bar(color="black",fill="green",alpha=0.2)+ylim(c(0,max(temp$Count)+5))+ylim(c(0,max(temp$Count)+5))+
theme(plot.margin=unit(c(-0.5,0,-0.6,0.2), "cm"), axis.text.y = element_blank(),axis.ticks.y = element_blank(),
axis.title=element_text(size=10,face="bold"),axis.text=element_text(size=12,face="bold"))+
geom_text(stat='count', aes(label=paste0("n=",..count..)), y=max(temp$Count)+5,size=ifelse(d>4,2.8,ifelse(d==4,3.5,4)))+
labs(title=" ",x="", y = "")
test[[i]]<-grid.arrange(g1,g2,b1,b2,ncol=2,nrow=2,bottom =(textGrob(names(Maize_best)[i+1],gp=gpar(fontsize = 12,cex=1.2,pos=1))))
g1<-ggplot(Maize_best[Maize_best$Clust=="1",], aes(x=as.factor(eval(parse(text=names(Maize_best)[i+1]))), y=Diff,fill=Clust))+
geom_boxplot(fill="orange",alpha=0.5)+ylim(c(0.19,0.32))+
theme(legend.position = "none",plot.margin=unit(c(-0.4,-0.1,-0.3,0), "cm"), axis.text.x = element_blank(), axis.ticks.y = element_blank(),
axis.ticks.x = element_blank(),axis.title=element_text(size=12,face="bold"),axis.text=element_text(size=12,face="bold"))+
stat_summary(fun = mean, geom = "point", shape=16, size=1,position=position_dodge(1))+
stat_boxplot(geom = "errorbar", width = 0.2) +
labs(title="",x="", y = ifelse(i==1|i==5,"Yield difference",""))
g1<-ggplot(Maize_best[Maize_best$Clust=="1",], aes(x=as.factor(eval(parse(text=names(Maize_best)[i+1]))), y=Diff,fill=Clust))+
geom_boxplot(fill="orange",alpha=0.5)+ylim(c(0.19,0.32))+
theme(legend.position = "none",plot.margin=unit(c(-0.4,-0.1,-0.3,0), "cm"), axis.text.x = element_blank(), axis.ticks.y = element_blank(),
axis.ticks.x = element_blank(),axis.title=element_text(size=12,face="bold"),axis.text=element_text(size=12,face="bold"))+
stat_summary(fun = mean, geom = "point", shape=16, size=1,position=position_dodge(1))+
stat_boxplot(geom = "errorbar", width = 0.2) +
labs(title="",x="", y = ifelse(i==1|i==5,"Yield difference",""))
ggplot(Maize_best[Maize_best$Clust=="1",], aes(x=as.factor(eval(parse(text=names(Maize_best)[i+1]))), y=Diff,fill=Clust))+
geom_boxplot(fill="orange",alpha=0.5)+ylim(c(0.19,0.32))+
theme(legend.position = "none",plot.margin=unit(c(-0.4,-0.1,-0.3,0), "cm"), axis.text.x = element_blank(), axis.ticks.y = element_blank(),
axis.ticks.x = element_blank(),axis.title=element_text(size=12,face="bold"),axis.text=element_text(size=12,face="bold"))+
stat_summary(fun = mean, geom = "point", shape=16, size=1,position=position_dodge(1))+
stat_boxplot(geom = "errorbar", width = 0.2) +
labs(title="",x="", y = ifelse(i==1|i==5,"Yield difference",""))
Maize_best[Maize_best$Clust=="1",] %>% group_by(Parm = factor(eval(parse(text=names(Maize_best)[i+1])))) %>%
summarise(Count = length(eval(parse(text=names(Maize_best)[i+1]))))
d=dim(temp)[1]
ggplot(Maize_best[Maize_best$Clust=="1",], aes(x=as.factor(eval(parse(text=names(Maize_best)[i+1])))))+
geom_bar(color="black",fill="orange",alpha=0.2)+ylim(c(0,max(temp$Count)+5))+ylim(c(0,max(temp$Count)+5))+
theme(plot.margin=unit(c(-0.5,-0.1,-0.6,0), "cm"),axis.ticks.y = element_blank(),
axis.title.y = element_text(margin = margin(t = 0, r = 12, b = 0, l = 0)),
axis.title=element_text(size=12,face="bold"),axis.text=element_text(size=12,face="bold"))+
geom_text(stat='count', aes(label=paste0("n=",..count..)), y=max(temp$Count)+5,size=ifelse(d>4,2.8,ifelse(d==4,3.5,4)))+
labs(title=" ",x="", y = ifelse(i==1|i==5,"Number of simulations",""))
temp <- Maize_best[Maize_best$Clust=="1",] %>% group_by(Parm = factor(eval(parse(text=names(Maize_best)[i+1])))) %>%
summarise(Count = length(eval(parse(text=names(Maize_best)[i+1]))))
d=dim(temp)[1]
ggplot(Maize_best[Maize_best$Clust=="1",], aes(x=as.factor(eval(parse(text=names(Maize_best)[i+1])))))+
geom_bar(color="black",fill="orange",alpha=0.2)+ylim(c(0,max(temp$Count)+5))+ylim(c(0,max(temp$Count)+5))+
theme(plot.margin=unit(c(-0.5,-0.1,-0.6,0), "cm"),axis.ticks.y = element_blank(),
axis.title.y = element_text(margin = margin(t = 0, r = 12, b = 0, l = 0)),
axis.title=element_text(size=12,face="bold"),axis.text=element_text(size=12,face="bold"))+
geom_text(stat='count', aes(label=paste0("n=",..count..)), y=max(temp$Count)+5,size=ifelse(d>4,2.8,ifelse(d==4,3.5,4)))+
labs(title=" ",x="", y = ifelse(i==1|i==5,"Number of simulations",""))
ggplot(Maize_best[Maize_best$Clust=="1",], aes(x=as.factor(eval(parse(text=names(Maize_best)[i+1])))))+
geom_bar(color="black",fill="orange",alpha=0.2)+ylim(c(0,max(temp$Count)+5))+
theme(plot.margin=unit(c(-0.5,-0.1,-0.6,0), "cm"),axis.ticks.y = element_blank(),
axis.title.y = element_text(margin = margin(t = 0, r = 12, b = 0, l = 0)),
axis.title=element_text(size=12,face="bold"),axis.text=element_text(size=12,face="bold"))+
geom_text(stat='count', aes(label=paste0("n=",..count..)), y=max(temp$Count)+5,size=ifelse(d>4,2.8,ifelse(d==4,3.5,4)))+
labs(title=" ",x="", y = ifelse(i==1|i==5,"Number of simulations",""))
g1<-ggplot(Maize_best[Maize_best$Clust=="1",], aes(x=as.factor(eval(parse(text=names(Maize_best)[i+1]))), y=Diff,fill=Clust))+
geom_boxplot(fill="orange",alpha=0.5)+ylim(c(0.19,0.32))+
theme(legend.position = "none",plot.margin=unit(c(-0.4,-0.1,-0.3,0), "cm"), axis.text.x = element_blank(), axis.ticks.y = element_blank(),
axis.ticks.x = element_blank(),axis.title=element_text(size=12,face="bold"),axis.text=element_text(size=12,face="bold"))+
stat_summary(fun = mean, geom = "point", shape=16, size=1,position=position_dodge(1))+
stat_boxplot(geom = "errorbar", width = 0.2) +
labs(title="",x="", y = ifelse(i==1|i==5,"Yield difference",""))
temp <- Maize_best[Maize_best$Clust=="1",] %>% group_by(Parm = factor(eval(parse(text=names(Maize_best)[i+1])))) %>%
summarise(Count = length(eval(parse(text=names(Maize_best)[i+1]))))
d=dim(temp)[1]
b1<-ggplot(Maize_best[Maize_best$Clust=="1",], aes(x=as.factor(eval(parse(text=names(Maize_best)[i+1])))))+
geom_bar(color="black",fill="orange",alpha=0.2)+ylim(c(0,max(temp$Count)+5))+
theme(plot.margin=unit(c(-0.5,-0.1,-0.6,0), "cm"),axis.ticks.y = element_blank(),
axis.title.y = element_text(margin = margin(t = 0, r = 12, b = 0, l = 0)),
axis.title=element_text(size=12,face="bold"),axis.text=element_text(size=12,face="bold"))+
geom_text(stat='count', aes(label=paste0("n=",..count..)), y=max(temp$Count)+5,size=ifelse(d>4,2.8,ifelse(d==4,3.5,4)))+
labs(title=" ",x="", y = ifelse(i==1|i==5,"Number of simulations",""))
g2<-ggplot(Maize_best[Maize_best$Clust=="2",], aes(x=as.factor(eval(parse(text=names(Maize_best)[i+1]))), y=Diff))+
geom_boxplot(fill="green",alpha=0.2)+ylim(c(0.19,0.32))+
theme(legend.position = "none",plot.margin=unit(c(-0.4,0,-0.3,0.2),"cm"), axis.text.y = element_blank(), axis.text.x = element_blank(),
axis.ticks.y = element_blank(),axis.title=element_text(size=10,face="bold"),axis.text=element_text(size=12,face="bold"),
axis.ticks.x = element_blank())+
stat_summary(fun = mean, geom = "point", shape=16, size=1,position=position_dodge(1))+
stat_boxplot(geom = "errorbar", width = 0.2) +
labs(title=" ",x="", y = "")
temp <- Maize_best[Maize_best$Clust=="2",] %>% group_by(Parm = factor(eval(parse(text=names(Maize_best)[i+1])))) %>%
summarise(Count = length(eval(parse(text=names(Maize_best)[i+1]))))
d=dim(temp)[1]
b2<-ggplot(Maize_best[Maize_best$Clust=="2",], aes(x=as.factor(eval(parse(text=names(Maize_best)[i+1])))))+
geom_bar(color="black",fill="green",alpha=0.2)+ylim(c(0,max(temp$Count)+5))+
theme(plot.margin=unit(c(-0.5,0,-0.6,0.2), "cm"), axis.text.y = element_blank(),axis.ticks.y = element_blank(),
axis.title=element_text(size=10,face="bold"),axis.text=element_text(size=12,face="bold"))+
geom_text(stat='count', aes(label=paste0("n=",..count..)), y=max(temp$Count)+5,size=ifelse(d>4,2.8,ifelse(d==4,3.5,4)))+
labs(title=" ",x="", y = "")
test[[i]]<-grid.arrange(g1,g2,b1,b2,ncol=2,nrow=2,bottom =(textGrob(names(Maize_best)[i+1],gp=gpar(fontsize = 12,cex=1.2,pos=1))))
i=3
g1<-ggplot(Maize_best[Maize_best$Clust=="1",], aes(x=as.factor(eval(parse(text=names(Maize_best)[i+1]))), y=Diff,fill=Clust))+
geom_boxplot(fill="orange",alpha=0.5)+ylim(c(0.19,0.32))+
theme(legend.position = "none",plot.margin=unit(c(-0.4,-0.1,-0.3,0), "cm"), axis.text.x = element_blank(), axis.ticks.y = element_blank(),
axis.ticks.x = element_blank(),axis.title=element_text(size=12,face="bold"),axis.text=element_text(size=12,face="bold"))+
stat_summary(fun = mean, geom = "point", shape=16, size=1,position=position_dodge(1))+
stat_boxplot(geom = "errorbar", width = 0.2) +
labs(title="",x="", y = ifelse(i==1|i==5,"Yield difference",""))
temp <- Maize_best[Maize_best$Clust=="1",] %>% group_by(Parm = factor(eval(parse(text=names(Maize_best)[i+1])))) %>%
summarise(Count = length(eval(parse(text=names(Maize_best)[i+1]))))
d=dim(temp)[1]
b1<-ggplot(Maize_best[Maize_best$Clust=="1",], aes(x=as.factor(eval(parse(text=names(Maize_best)[i+1])))))+
geom_bar(color="black",fill="orange",alpha=0.2)+ylim(c(0,max(temp$Count)+5))+
theme(plot.margin=unit(c(-0.5,-0.1,-0.6,0), "cm"),axis.ticks.y = element_blank(),
axis.title.y = element_text(margin = margin(t = 0, r = 12, b = 0, l = 0)),
axis.title=element_text(size=12,face="bold"),axis.text=element_text(size=12,face="bold"))+
geom_text(stat='count', aes(label=paste0("n=",..count..)), y=max(temp$Count)+5,size=ifelse(d>4,2.8,ifelse(d==4,3.5,4)))+
labs(title=" ",x="", y = ifelse(i==1|i==5,"Number of simulations",""))
g2<-ggplot(Maize_best[Maize_best$Clust=="2",], aes(x=as.factor(eval(parse(text=names(Maize_best)[i+1]))), y=Diff))+
geom_boxplot(fill="green",alpha=0.2)+ylim(c(0.19,0.32))+
theme(legend.position = "none",plot.margin=unit(c(-0.4,0,-0.3,0.2),"cm"), axis.text.y = element_blank(), axis.text.x = element_blank(),
axis.ticks.y = element_blank(),axis.title=element_text(size=10,face="bold"),axis.text=element_text(size=12,face="bold"),
axis.ticks.x = element_blank())+
stat_summary(fun = mean, geom = "point", shape=16, size=1,position=position_dodge(1))+
stat_boxplot(geom = "errorbar", width = 0.2) +
labs(title=" ",x="", y = "")
temp <- Maize_best[Maize_best$Clust=="2",] %>% group_by(Parm = factor(eval(parse(text=names(Maize_best)[i+1])))) %>%
summarise(Count = length(eval(parse(text=names(Maize_best)[i+1]))))
d=dim(temp)[1]
b2<-ggplot(Maize_best[Maize_best$Clust=="2",], aes(x=as.factor(eval(parse(text=names(Maize_best)[i+1])))))+
geom_bar(color="black",fill="green",alpha=0.2)+ylim(c(0,max(temp$Count)+5))+
theme(plot.margin=unit(c(-0.5,0,-0.6,0.2), "cm"), axis.text.y = element_blank(),axis.ticks.y = element_blank(),
axis.title=element_text(size=10,face="bold"),axis.text=element_text(size=12,face="bold"))+
geom_text(stat='count', aes(label=paste0("n=",..count..)), y=max(temp$Count)+5,size=ifelse(d>4,2.8,ifelse(d==4,3.5,4)))+
labs(title=" ",x="", y = "")
test[[i]]<-grid.arrange(g1,g2,b1,b2,ncol=2,nrow=2,bottom =(textGrob(names(Maize_best)[i+1],gp=gpar(fontsize = 12,cex=1.2,pos=1))))
ggplot(Maize_best[Maize_best$Clust=="2",], aes(x=as.factor(eval(parse(text=names(Maize_best)[i+1]))), y=Diff))+
geom_boxplot(fill="green",alpha=0.2)+ylim(c(0.19,0.32))+
theme(legend.position = "none",plot.margin=unit(c(-0.4,0,-0.3,0.2),"cm"), axis.text.y = element_blank(), axis.text.x = element_blank(),
axis.ticks.y = element_blank(),axis.title=element_text(size=10,face="bold"),axis.text=element_text(size=12,face="bold"),
axis.ticks.x = element_blank())+
stat_summary(fun = mean, geom = "point", shape=16, size=1,position=position_dodge(1))+
stat_boxplot(geom = "errorbar", width = 0.2) +
labs(title=" ",x="", y = "")
i=2
ggplot(Maize_best[Maize_best$Clust=="2",], aes(x=as.factor(eval(parse(text=names(Maize_best)[i+1]))), y=Diff))+
geom_boxplot(fill="green",alpha=0.2)+ylim(c(0.19,0.32))+
theme(legend.position = "none",plot.margin=unit(c(-0.4,0,-0.3,0.2),"cm"), axis.text.y = element_blank(), axis.text.x = element_blank(),
axis.ticks.y = element_blank(),axis.title=element_text(size=10,face="bold"),axis.text=element_text(size=12,face="bold"),
axis.ticks.x = element_blank())+
stat_summary(fun = mean, geom = "point", shape=16, size=1,position=position_dodge(1))+
stat_boxplot(geom = "errorbar", width = 0.2) +
labs(title=" ",x="", y = "")
ggplot(Maize_best[Maize_best$Clust=="1",], aes(x=as.factor(eval(parse(text=names(Maize_best)[i+1]))), y=Diff,fill=Clust))+
geom_boxplot(fill="orange",alpha=0.5)+ylim(c(0.19,0.32))+
theme(legend.position = "none",plot.margin=unit(c(-0.4,-0.1,-0.3,0), "cm"), axis.text.x = element_blank(), axis.ticks.y = element_blank(),
axis.ticks.x = element_blank(),axis.title=element_text(size=12,face="bold"),axis.text=element_text(size=12,face="bold"))+
stat_summary(fun = mean, geom = "point", shape=16, size=1,position=position_dodge(1))+
stat_boxplot(geom = "errorbar", width = 0.2) +
labs(title="",x="", y = ifelse(i==1|i==5,"Yield difference",""))
ggplot(Maize_best[Maize_best$Clust=="2",], aes(x=as.factor(eval(parse(text=names(Maize_best)[i+1]))), y=Diff,fill=Clust))+
geom_boxplot(fill="green",alpha=0.5)+ylim(c(0.19,0.32))+
theme(legend.position = "none",plot.margin=unit(c(-0.4,-0.1,-0.3,0.2),"cm"), axis.text.y = element_blank(), axis.text.x = element_blank(),
axis.ticks.y = element_blank(),axis.title=element_text(size=12,face="bold"),axis.text=element_text(size=12,face="bold")+
stat_summary(fun = mean, geom = "point", shape=16, size=1,position=position_dodge(1))+
stat_boxplot(geom = "errorbar", width = 0.2) +
labs(title=" ",x="", y = ""))
ggplot(Maize_best[Maize_best$Clust=="2",], aes(x=as.factor(eval(parse(text=names(Maize_best)[i+1]))), y=Diff,fill=Clust))+
geom_boxplot(fill="green",alpha=0.5)+ylim(c(0.19,0.32))+
theme(legend.position = "none",plot.margin=unit(c(-0.4,-0.1,-0.3,0.2),"cm"), axis.text.y = element_blank(), axis.text.x = element_blank(),
axis.ticks.y = element_blank(),axis.title=element_text(size=12,face="bold"),axis.text=element_text(size=12,face="bold"))+
stat_summary(fun = mean, geom = "point", shape=16, size=1,position=position_dodge(1))+
stat_boxplot(geom = "errorbar", width = 0.2) +
labs(title=" ",x="", y = "")
i
Maize_best[Maize_best$Clust=="2",]
ggplot(Maize_best[Maize_best$Clust=="2",], aes(x=as.factor(eval(parse(text=names(Maize_best)[i+1]))), y=Diff,fill=Clust))
ggplot(Maize_best[Maize_best$Clust=="2",], aes(x=as.factor(eval(parse(text=names(Maize_best)[i+1]))), y=Diff,fill=Clust))+
geom_boxplot(fill="green",alpha=0.5)+ylim(c(0.19,0.32))
names(Maize_best)[i+1]
i
eval(parse(text=names(Maize_best)[i+1]))
x=as.factor(eval(parse(text=names(Maize_best)[i+1])))
x=as.factor(eval(parse(text=paste0(Maize_best$,names(Maize_best)[i+1]))))
paste0(Maize_best$,names(Maize_best)[i+1])
paste0("Maize_best$",names(Maize_best)[i+1])
x=as.factor(eval(parse(text=paste0("Maize_best$",names(Maize_best)[i+1]))))
x
x=as.factor(eval(parse(text=paste0("Maize_best$",names(Maize_best)[i+1],"[Maize_best$Clust=="2",]"))))
[Maize_best$Clust=="2",]
paste0("Maize_best$",names(Maize_best)[i+1],"[Maize_best$Clust=="2",]")
View(MaizBest)
View(Maize_best)
paste0("Maize_best$",names(Maize_best)[i+1],"[Maize_best$Clust=="2",c(51:100)]")
x=as.factor(eval(parse(text=paste0("Maize_best$",names(Maize_best)[i+1],"[Maize_best$Clust=="2",c(51:100)]"))))
x=as.factor(eval(parse(text=paste0("Maize_best$",names(Maize_best)[i+1],"[,c(51:100)]"))))
paste0("Maize_best$",names(Maize_best)[i+1],"[,c(51:100)]")
paste0("Maize_best$",names(Maize_best)[i+1],"[c(51:100)]")
Maize_best$SLA[c(51:100)]
x=as.factor(eval(parse(text=paste0("Maize_best$",names(Maize_best)[i+1],"[c(51:100)]"))))
x
ggplot(Maize_best[Maize_best$Clust=="2",], aes(x=as.factor(eval(parse(text=names(Maize_best)[i+1]))), y=Diff))+
geom_boxplot(fill="green",alpha=0.5)+ylim(c(0.19,0.32))
ggplot(Maize_best[Maize_best$Clust=="2",], aes(x=as.factor(eval(parse(text=names(Maize_best)[i+1]))), y=Diff))+
geom_boxplot(fill="green",alpha=0.5)+ylim(c(0.19,0.35))
ggplot(Maize_best[Maize_best$Clust=="2",], aes(x=as.factor(eval(parse(text=names(Maize_best)[i+1]))), y=Diff))+
geom_boxplot(fill="green",alpha=0.5)+ylim(c(0.19,0.40))
for (i in 1:8){
g1<-ggplot(Maize_best[Maize_best$Clust=="1",], aes(x=as.factor(eval(parse(text=names(Maize_best)[i+1]))), y=Diff,fill=Clust))+
geom_boxplot(fill="orange",alpha=0.5)+ylim(c(0.19,0.32))+
theme(legend.position = "none",plot.margin=unit(c(-0.4,-0.1,-0.3,0), "cm"), axis.text.x = element_blank(), axis.ticks.y = element_blank(),
axis.ticks.x = element_blank(),axis.title=element_text(size=12,face="bold"),axis.text=element_text(size=12,face="bold"))+
stat_summary(fun = mean, geom = "point", shape=16, size=1,position=position_dodge(1))+
stat_boxplot(geom = "errorbar", width = 0.2) +
labs(title="",x="", y = ifelse(i==1|i==5,"Yield difference",""))
temp <- Maize_best[Maize_best$Clust=="1",] %>% group_by(Parm = factor(eval(parse(text=names(Maize_best)[i+1])))) %>%
summarise(Count = length(eval(parse(text=names(Maize_best)[i+1]))))
d=dim(temp)[1]
b1<-ggplot(Maize_best[Maize_best$Clust=="1",], aes(x=as.factor(eval(parse(text=names(Maize_best)[i+1])))))+
geom_bar(color="black",fill="orange",alpha=0.2)+ylim(c(0,max(temp$Count)+5))+
theme(plot.margin=unit(c(-0.5,-0.1,-0.6,0), "cm"),axis.ticks.y = element_blank(),
axis.title.y = element_text(margin = margin(t = 0, r = 12, b = 0, l = 0)),
axis.title=element_text(size=12,face="bold"),axis.text=element_text(size=12,face="bold"))+
geom_text(stat='count', aes(label=paste0("n=",..count..)), y=max(temp$Count)+5,size=ifelse(d>4,2.8,ifelse(d==4,3.5,4)))+
labs(title=" ",x="", y = ifelse(i==1|i==5,"Number of simulations",""))
g2<-ggplot(Maize_best[Maize_best$Clust=="2",], aes(x=as.factor(eval(parse(text=names(Maize_best)[i+1]))), y=Diff))+
geom_boxplot(fill="green",alpha=0.5)+ylim(c(0.19,0.40))+
theme(legend.position = "none",plot.margin=unit(c(-0.4,-0.1,-0.3,0.2),"cm"), axis.text.y = element_blank(), axis.text.x = element_blank(),
axis.ticks.y = element_blank(),axis.title=element_text(size=12,face="bold"),axis.text=element_text(size=12,face="bold"))+
stat_summary(fun = mean, geom = "point", shape=16, size=1,position=position_dodge(1))+
stat_boxplot(geom = "errorbar", width = 0.2) +
labs(title=" ",x="", y = "")
temp <- Maize_best[Maize_best$Clust=="2",] %>% group_by(Parm = factor(eval(parse(text=names(Maize_best)[i+1])))) %>%
summarise(Count = length(eval(parse(text=names(Maize_best)[i+1]))))
d=dim(temp)[1]
b2<-ggplot(Maize_best[Maize_best$Clust=="2",], aes(x=as.factor(eval(parse(text=names(Maize_best)[i+1])))))+
geom_bar(color="black",fill="green",alpha=0.2)+ylim(c(0,max(temp$Count)+5))+
theme(plot.margin=unit(c(-0.5,0,-0.6,0.2), "cm"), axis.text.y = element_blank(),axis.ticks.y = element_blank(),
axis.title=element_text(size=10,face="bold"),axis.text=element_text(size=12,face="bold"))+
geom_text(stat='count', aes(label=paste0("n=",..count..)), y=max(temp$Count)+5,size=ifelse(d>4,2.8,ifelse(d==4,3.5,4)))+
labs(title=" ",x="", y = "")
test[[i]]<-grid.arrange(g1,g2,b1,b2,ncol=2,nrow=2,bottom =(textGrob(names(Maize_best)[i+1],gp=gpar(fontsize = 12,cex=1.2,pos=1))))
}
do.call("grid.arrange",c(test,nrow=2))
#Wheat
Wheat_NsenS<-subset(SSE3w,PercSWi>10&HIav_Sp<=0.45&HIav_Sp>=0.3)
Spring<-Wheat_NsenS[order(Wheat_NsenS$SpringC),][c(1:50),-c(3:7,16:19)]
Spring$Cult="Spring";names(Spring)[2]="Diff"
Wheat_NsenW<-subset(SSE3w,PercWWi>10&HIav_Wi<=0.45&HIav_Wi>=0.3)
Winter<-Wheat_NsenW[order(Wheat_NsenW$WinterC),][c(1:50),-c(2,4:7,16:19)]
Winter$Cult="Winter";names(Winter)[2]="Diff"
Wheat_best=rbind(Spring,Winter)[,-1]
Wheat_best$CN_range=round(Wheat_best$CN_range,1);Wheat_best$N_dem_re=round(Wheat_best$N_dem_re,1)
TestW<-as.data.frame(lapply(Wheat_best[,c(3:10)],as.factor))
names(TestW)<-c("SLA","CNmin","CNRange","Nret","Cret","kN","Ndred","Cult")
summary(TestW,nbelements=Inf)
acm<-dudi.acm(TestW,nf=10,scannf = F)
grp <- as.factor(TestW[, "Cult"])
options(ggrepel.max.overlaps = Inf)
fviz_mca_biplot(acm, repel=T,label="var",habillage=grp, invisible="none", col.var = "black",pointsize.ind=0.2,labelsize=5,alpha.ind = 1/8, axes = c(1, 2),
addEllipses=TRUE, ellipse.level=0.95)+labs(title ="Correspondence Analysis Maize")+theme(text = element_text(size = 25),axis.title = element_text(size = 20),
axis.text = element_text(size = 20),plot.title = element_text( hjust = 0.5))
boxplot(acm)
names()
testw<-list()
names(Wheat_best)<-c("Diff", "Sret","SLA","CNmin","CNrange","Nret","Cret","kN","Ndred","Cult")
for (i in 1:8){
g1<-ggplot(Wheat_best[Wheat_best$Cult=="Spring",], aes(x=as.factor(eval(parse(text=names(Wheat_best)[i+1]))), y=Diff,fill=Cult))+
geom_boxplot(fill="orange",alpha=0.5)+ylim(c(0.24,0.35))+
theme(legend.position = "none",plot.margin=unit(c(-0.4,-0.1,-0.3,0), "cm"),axis.text.x = element_blank(), axis.ticks.y = element_blank(),
axis.ticks.x = element_blank(),axis.title=element_text(size=12,face="bold"),axis.text=element_text(size=12,face="bold"))+
stat_summary(fun = mean, geom = "point", shape=16, size=1,position=position_dodge(1))+
stat_boxplot(geom = "errorbar", width = 0.2) +
labs(title="",x="", y = ifelse(i==1|i==5,"Yield difference",""))
temp <- Wheat_best[Wheat_best$Cult=="Spring",] %>% group_by(Parm = factor(eval(parse(text=names(Wheat_best)[i+1])))) %>%
summarise(Count = length(eval(parse(text=names(Wheat_best)[i+1]))))
d=dim(temp)[1]
b1<-ggplot(Wheat_best[Wheat_best$Cult=="Spring",], aes(x=as.factor(eval(parse(text=names(Wheat_best)[i+1])))))+
geom_bar(color="black",fill="orange",alpha=0.2)+ylim(c(0,max(temp$Count)+5))+
theme(plot.margin=unit(c(-0.5,-0.1,-0.6,0), "cm"),axis.ticks.y = element_blank(),
axis.title.y = element_text(margin = margin(t = 0, r = 12, b = 0, l = 0)),
axis.title=element_text(size=12,face="bold"),axis.text=element_text(size=12,face="bold"))+
geom_text(stat='count', aes(label=paste0("n=",..count..)), y=max(temp$Count)+5,size=ifelse(d>4,2.8,ifelse(d==4,3.5,4)))+
labs(title=" ",x="", y = ifelse(i==1|i==5,"Number of simulations",""))
g2<-ggplot(Wheat_best[Wheat_best$Cult=="Winter",], aes(x=as.factor(eval(parse(text=names(Wheat_best)[i+1]))), y=Diff))+
geom_boxplot(fill="green",alpha=0.2)+ylim(c(0.24,0.38))+
theme(legend.position = "none",plot.margin=unit(c(-0.4,0,-0.3,0.2),"cm"),axis.text.y = element_blank(),
axis.text.x = element_blank(),axis.ticks.y = element_blank(),axis.ticks.x = element_blank(),
axis.title=element_text(size=10,face="bold"),axis.text=element_text(size=12,face="bold"))+
stat_summary(fun = mean, geom = "point", shape=16, size=1,position=position_dodge(1))+
stat_boxplot(geom = "errorbar", width = 0.2) +
labs(title=" ",x="", y = "")
temp <- Wheat_best[Wheat_best$Cult=="Winter",] %>% group_by(Parm = factor(eval(parse(text=names(Wheat_best)[i+1])))) %>%
summarise(Count = length(eval(parse(text=names(Wheat_best)[i+1]))))
d=dim(temp)[1]
b2<-ggplot(Wheat_best[Wheat_best$Cult=="Winter",], aes(x=as.factor(eval(parse(text=names(Wheat_best)[i+1])))))+
geom_bar(color="black",fill="green",alpha=0.2)+ylim(c(0,max(temp$Count)+5))+
theme(plot.margin=unit(c(-0.5,0,-0.6,0.2), "cm"), axis.text.y = element_blank(),axis.ticks.y = element_blank(),
axis.title=element_text(size=10,face="bold"),axis.text=element_text(size=12,face="bold"))+
geom_text(stat='count', aes(label=paste0("n=",..count..)), y=max(temp$Count)+5,size=ifelse(d>4,2.8,ifelse(d==4,3.5,4)))+
labs(title=" ",x="", y = "")
testw[[i]]<-grid.arrange(g1,g2,b1,b2,ncol=2,nrow=2,bottom =(textGrob(names(Wheat_best)[i+1],gp=gpar(fontsize = 12,cex=1.2,pos=2))))
}
do.call("grid.arrange",c(testw,nrow=2))
for (i in 1:8){
g1<-ggplot(Wheat_best[Wheat_best$Cult=="Spring",], aes(x=as.factor(eval(parse(text=names(Wheat_best)[i+1]))), y=Diff,fill=Cult))+
geom_boxplot(fill="orange",alpha=0.5)+ylim(c(0.24,0.35))+
theme(legend.position = "none",plot.margin=unit(c(-0.4,-0.1,-0.3,0), "cm"),axis.text.x = element_blank(), axis.ticks.y = element_blank(),
axis.ticks.x = element_blank(),axis.title=element_text(size=12,face="bold"),axis.text=element_text(size=12,face="bold"))+
stat_summary(fun = mean, geom = "point", shape=16, size=1,position=position_dodge(1))+
stat_boxplot(geom = "errorbar", width = 0.2) +
labs(title="",x="", y = ifelse(i==1|i==5,"Yield difference",""))
temp <- Wheat_best[Wheat_best$Cult=="Spring",] %>% group_by(Parm = factor(eval(parse(text=names(Wheat_best)[i+1])))) %>%
summarise(Count = length(eval(parse(text=names(Wheat_best)[i+1]))))
d=dim(temp)[1]
b1<-ggplot(Wheat_best[Wheat_best$Cult=="Spring",], aes(x=as.factor(eval(parse(text=names(Wheat_best)[i+1])))))+
geom_bar(color="black",fill="orange",alpha=0.2)+ylim(c(0,max(temp$Count)+5))+
theme(plot.margin=unit(c(-0.5,-0.1,-0.6,0), "cm"),axis.ticks.y = element_blank(),
axis.title.y = element_text(margin = margin(t = 0, r = 12, b = 0, l = 0)),
axis.title=element_text(size=12,face="bold"),axis.text=element_text(size=12,face="bold"))+
geom_text(stat='count', aes(label=paste0("n=",..count..)), y=max(temp$Count)+5,size=ifelse(d>4,2.8,ifelse(d==4,3.5,4)))+
labs(title=" ",x="", y = ifelse(i==1|i==5,"Number of simulations",""))
g2<-ggplot(Wheat_best[Wheat_best$Cult=="Winter",], aes(x=as.factor(eval(parse(text=names(Wheat_best)[i+1]))), y=Diff))+
geom_boxplot(fill="green",alpha=0.2)+ylim(c(0.24,0.36))+
theme(legend.position = "none",plot.margin=unit(c(-0.4,0,-0.3,0.2),"cm"),axis.text.y = element_blank(),
axis.text.x = element_blank(),axis.ticks.y = element_blank(),axis.ticks.x = element_blank(),
axis.title=element_text(size=10,face="bold"),axis.text=element_text(size=12,face="bold"))+
stat_summary(fun = mean, geom = "point", shape=16, size=1,position=position_dodge(1))+
stat_boxplot(geom = "errorbar", width = 0.2) +
labs(title=" ",x="", y = "")
temp <- Wheat_best[Wheat_best$Cult=="Winter",] %>% group_by(Parm = factor(eval(parse(text=names(Wheat_best)[i+1])))) %>%
summarise(Count = length(eval(parse(text=names(Wheat_best)[i+1]))))
d=dim(temp)[1]
b2<-ggplot(Wheat_best[Wheat_best$Cult=="Winter",], aes(x=as.factor(eval(parse(text=names(Wheat_best)[i+1])))))+
geom_bar(color="black",fill="green",alpha=0.2)+ylim(c(0,max(temp$Count)+5))+
theme(plot.margin=unit(c(-0.5,0,-0.6,0.2), "cm"), axis.text.y = element_blank(),axis.ticks.y = element_blank(),
axis.title=element_text(size=10,face="bold"),axis.text=element_text(size=12,face="bold"))+
geom_text(stat='count', aes(label=paste0("n=",..count..)), y=max(temp$Count)+5,size=ifelse(d>4,2.8,ifelse(d==4,3.5,4)))+
labs(title=" ",x="", y = "")
testw[[i]]<-grid.arrange(g1,g2,b1,b2,ncol=2,nrow=2,bottom =(textGrob(names(Wheat_best)[i+1],gp=gpar(fontsize = 12,cex=1.2,pos=2))))
}
do.call("grid.arrange",c(testw,nrow=2))
for (i in 1:8){
g1<-ggplot(Wheat_best[Wheat_best$Cult=="Spring",], aes(x=as.factor(eval(parse(text=names(Wheat_best)[i+1]))), y=Diff,fill=Cult))+
geom_boxplot(fill="orange",alpha=0.5)+ylim(c(0.24,0.35))+
theme(legend.position = "none",plot.margin=unit(c(-0.4,-0.1,-0.3,0), "cm"),axis.text.x = element_blank(), axis.ticks.y = element_blank(),
axis.ticks.x = element_blank(),axis.title=element_text(size=12,face="bold"),axis.text=element_text(size=12,face="bold"))+
stat_summary(fun = mean, geom = "point", shape=16, size=1,position=position_dodge(1))+
stat_boxplot(geom = "errorbar", width = 0.2) +
labs(title="",x="", y = ifelse(i==1|i==5,"Yield difference",""))
temp <- Wheat_best[Wheat_best$Cult=="Spring",] %>% group_by(Parm = factor(eval(parse(text=names(Wheat_best)[i+1])))) %>%
summarise(Count = length(eval(parse(text=names(Wheat_best)[i+1]))))
d=dim(temp)[1]
b1<-ggplot(Wheat_best[Wheat_best$Cult=="Spring",], aes(x=as.factor(eval(parse(text=names(Wheat_best)[i+1])))))+
geom_bar(color="black",fill="orange",alpha=0.2)+ylim(c(0,max(temp$Count)+5))+
theme(plot.margin=unit(c(-0.5,-0.1,-0.6,0), "cm"),axis.ticks.y = element_blank(),
axis.title.y = element_text(margin = margin(t = 0, r = 12, b = 0, l = 0)),
axis.title=element_text(size=12,face="bold"),axis.text=element_text(size=12,face="bold"))+
geom_text(stat='count', aes(label=paste0("n=",..count..)), y=max(temp$Count)+5,size=ifelse(d>4,2.8,ifelse(d==4,3.5,4)))+
labs(title=" ",x="", y = ifelse(i==1|i==5,"Number of simulations",""))
g2<-ggplot(Wheat_best[Wheat_best$Cult=="Winter",], aes(x=as.factor(eval(parse(text=names(Wheat_best)[i+1]))), y=Diff))+
geom_boxplot(fill="green",alpha=0.5)+ylim(c(0.24,0.36))+
theme(legend.position = "none",plot.margin=unit(c(-0.4,0,-0.3,0.2),"cm"),axis.text.y = element_blank(),
axis.text.x = element_blank(),axis.ticks.y = element_blank(),axis.ticks.x = element_blank(),
axis.title=element_text(size=10,face="bold"),axis.text=element_text(size=12,face="bold"))+
stat_summary(fun = mean, geom = "point", shape=16, size=1,position=position_dodge(1))+
stat_boxplot(geom = "errorbar", width = 0.2) +
labs(title=" ",x="", y = "")
temp <- Wheat_best[Wheat_best$Cult=="Winter",] %>% group_by(Parm = factor(eval(parse(text=names(Wheat_best)[i+1])))) %>%
summarise(Count = length(eval(parse(text=names(Wheat_best)[i+1]))))
d=dim(temp)[1]
b2<-ggplot(Wheat_best[Wheat_best$Cult=="Winter",], aes(x=as.factor(eval(parse(text=names(Wheat_best)[i+1])))))+
geom_bar(color="black",fill="green",alpha=0.2)+ylim(c(0,max(temp$Count)+5))+
theme(plot.margin=unit(c(-0.5,0,-0.6,0.2), "cm"), axis.text.y = element_blank(),axis.ticks.y = element_blank(),
axis.title=element_text(size=10,face="bold"),axis.text=element_text(size=12,face="bold"))+
geom_text(stat='count', aes(label=paste0("n=",..count..)), y=max(temp$Count)+5,size=ifelse(d>4,2.8,ifelse(d==4,3.5,4)))+
labs(title=" ",x="", y = "")
testw[[i]]<-grid.arrange(g1,g2,b1,b2,ncol=2,nrow=2,bottom =(textGrob(names(Wheat_best)[i+1],gp=gpar(fontsize = 12,cex=1.2,pos=2))))
}
do.call("grid.arrange",c(testw,nrow=2))
for (i in 1:8){
g1<-ggplot(Wheat_best[Wheat_best$Cult=="Spring",], aes(x=as.factor(eval(parse(text=names(Wheat_best)[i+1]))), y=Diff,fill=Cult))+
geom_boxplot(fill="orange",alpha=0.5)+ylim(c(0.24,0.35))+
theme(legend.position = "none",plot.margin=unit(c(-0.4,-0.1,-0.3,0), "cm"),axis.text.x = element_blank(), axis.ticks.y = element_blank(),
axis.ticks.x = element_blank(),axis.title=element_text(size=12,face="bold"),axis.text=element_text(size=12,face="bold"))+
stat_summary(fun = mean, geom = "point", shape=16, size=1,position=position_dodge(1))+
stat_boxplot(geom = "errorbar", width = 0.2) +
labs(title="",x="", y = ifelse(i==1|i==5,"Yield difference",""))
temp <- Wheat_best[Wheat_best$Cult=="Spring",] %>% group_by(Parm = factor(eval(parse(text=names(Wheat_best)[i+1])))) %>%
summarise(Count = length(eval(parse(text=names(Wheat_best)[i+1]))))
d=dim(temp)[1]
b1<-ggplot(Wheat_best[Wheat_best$Cult=="Spring",], aes(x=as.factor(eval(parse(text=names(Wheat_best)[i+1])))))+
geom_bar(color="black",fill="orange",alpha=0.5)+ylim(c(0,max(temp$Count)+5))+
theme(plot.margin=unit(c(-0.5,-0.1,-0.6,0), "cm"),axis.ticks.y = element_blank(),
axis.title.y = element_text(margin = margin(t = 0, r = 12, b = 0, l = 0)),
axis.title=element_text(size=12,face="bold"),axis.text=element_text(size=12,face="bold"))+
geom_text(stat='count', aes(label=paste0("n=",..count..)), y=max(temp$Count)+5,size=ifelse(d>4,2.8,ifelse(d==4,3.5,4)))+
labs(title=" ",x="", y = ifelse(i==1|i==5,"Number of simulations",""))
g2<-ggplot(Wheat_best[Wheat_best$Cult=="Winter",], aes(x=as.factor(eval(parse(text=names(Wheat_best)[i+1]))), y=Diff))+
geom_boxplot(fill="green",alpha=0.5)+ylim(c(0.24,0.36))+
theme(legend.position = "none",plot.margin=unit(c(-0.4,0,-0.3,0.2),"cm"),axis.text.y = element_blank(),
axis.text.x = element_blank(),axis.ticks.y = element_blank(),axis.ticks.x = element_blank(),
axis.title=element_text(size=10,face="bold"),axis.text=element_text(size=12,face="bold"))+
stat_summary(fun = mean, geom = "point", shape=16, size=1,position=position_dodge(1))+
stat_boxplot(geom = "errorbar", width = 0.2) +
labs(title=" ",x="", y = "")
temp <- Wheat_best[Wheat_best$Cult=="Winter",] %>% group_by(Parm = factor(eval(parse(text=names(Wheat_best)[i+1])))) %>%
summarise(Count = length(eval(parse(text=names(Wheat_best)[i+1]))))
d=dim(temp)[1]
b2<-ggplot(Wheat_best[Wheat_best$Cult=="Winter",], aes(x=as.factor(eval(parse(text=names(Wheat_best)[i+1])))))+
geom_bar(color="black",fill="green",alpha=0.5)+ylim(c(0,max(temp$Count)+5))+
theme(plot.margin=unit(c(-0.5,0,-0.6,0.2), "cm"), axis.text.y = element_blank(),axis.ticks.y = element_blank(),
axis.title=element_text(size=10,face="bold"),axis.text=element_text(size=12,face="bold"))+
geom_text(stat='count', aes(label=paste0("n=",..count..)), y=max(temp$Count)+5,size=ifelse(d>4,2.8,ifelse(d==4,3.5,4)))+
labs(title=" ",x="", y = "")
testw[[i]]<-grid.arrange(g1,g2,b1,b2,ncol=2,nrow=2,bottom =(textGrob(names(Wheat_best)[i+1],gp=gpar(fontsize = 12,cex=1.2,pos=2))))
}
do.call("grid.arrange",c(testw,nrow=2))
for (i in 1:8){
g1<-ggplot(Maize_best[Maize_best$Clust=="1",], aes(x=as.factor(eval(parse(text=names(Maize_best)[i+1]))), y=Diff,fill=Clust))+
geom_boxplot(fill="orange",alpha=0.5)+ylim(c(0.19,0.32))+
theme(legend.position = "none",plot.margin=unit(c(-0.4,-0.1,-0.3,0), "cm"), axis.text.x = element_blank(), axis.ticks.y = element_blank(),
axis.ticks.x = element_blank(),axis.title=element_text(size=12,face="bold"),axis.text=element_text(size=12,face="bold"))+
stat_summary(fun = mean, geom = "point", shape=16, size=1,position=position_dodge(1))+
stat_boxplot(geom = "errorbar", width = 0.2) +
labs(title="",x="", y = ifelse(i==1|i==5,"Yield difference",""))
temp <- Maize_best[Maize_best$Clust=="1",] %>% group_by(Parm = factor(eval(parse(text=names(Maize_best)[i+1])))) %>%
summarise(Count = length(eval(parse(text=names(Maize_best)[i+1]))))
d=dim(temp)[1]
b1<-ggplot(Maize_best[Maize_best$Clust=="1",], aes(x=as.factor(eval(parse(text=names(Maize_best)[i+1])))))+
geom_bar(color="black",fill="orange",alpha=0.5)+ylim(c(0,max(temp$Count)+5))+
theme(plot.margin=unit(c(-0.5,-0.1,-0.6,0), "cm"),axis.ticks.y = element_blank(),
axis.title.y = element_text(margin = margin(t = 0, r = 12, b = 0, l = 0)),
axis.title=element_text(size=12,face="bold"),axis.text=element_text(size=12,face="bold"))+
geom_text(stat='count', aes(label=paste0("n=",..count..)), y=max(temp$Count)+5,size=ifelse(d>4,2.8,ifelse(d==4,3.5,4)))+
labs(title=" ",x="", y = ifelse(i==1|i==5,"Number of simulations",""))
g2<-ggplot(Maize_best[Maize_best$Clust=="2",], aes(x=as.factor(eval(parse(text=names(Maize_best)[i+1]))), y=Diff))+
geom_boxplot(fill="green",alpha=0.5)+ylim(c(0.19,0.40))+
theme(legend.position = "none",plot.margin=unit(c(-0.4,-0.1,-0.3,0.2),"cm"), axis.text.y = element_blank(), axis.text.x = element_blank(),
axis.ticks.y = element_blank(),axis.title=element_text(size=12,face="bold"),axis.text=element_text(size=12,face="bold"))+
stat_summary(fun = mean, geom = "point", shape=16, size=1,position=position_dodge(1))+
stat_boxplot(geom = "errorbar", width = 0.2) +
labs(title=" ",x="", y = "")
temp <- Maize_best[Maize_best$Clust=="2",] %>% group_by(Parm = factor(eval(parse(text=names(Maize_best)[i+1])))) %>%
summarise(Count = length(eval(parse(text=names(Maize_best)[i+1]))))
d=dim(temp)[1]
b2<-ggplot(Maize_best[Maize_best$Clust=="2",], aes(x=as.factor(eval(parse(text=names(Maize_best)[i+1])))))+
geom_bar(color="black",fill="green",alpha=0.5)+ylim(c(0,max(temp$Count)+5))+
theme(plot.margin=unit(c(-0.5,0,-0.6,0.2), "cm"), axis.text.y = element_blank(),axis.ticks.y = element_blank(),
axis.title=element_text(size=10,face="bold"),axis.text=element_text(size=12,face="bold"))+
geom_text(stat='count', aes(label=paste0("n=",..count..)), y=max(temp$Count)+5,size=ifelse(d>4,2.8,ifelse(d==4,3.5,4)))+
labs(title=" ",x="", y = "")
test[[i]]<-grid.arrange(g1,g2,b1,b2,ncol=2,nrow=2,bottom =(textGrob(names(Maize_best)[i+1],gp=gpar(fontsize = 12,cex=1.2,pos=1))))
}
do.call("grid.arrange",c(test,nrow=2))
library(ggplot2)
library(rworldmap)
ObsC_<-Yi_HIm[c(1:22),c(10:11,18)]
ObsC_$color=ifelse(ObsC_$Cluster==1,"red","purple")
ObsW$color=ifelse(ObsW$wheat=="Spring","black","blue")
dev.new()
par(mai=c(0.5,0,0.2,0),xaxs="i",yaxs="i")
mapBubbles( dF=getMap(),
, oceanCol="lightblue"
, landCol="wheat" )
points(ObsC_$Lon, ObsC_$Lat, pch =  16, col=ObsC_$color)
points(ObsW$Lon, ObsW$Lat, pch =  17, col=ObsW$color)
legend(x="bottom", legend =c("Maize-High yield", "Maize-Low yield","Wheat-Spring","Wheat-Winter") ,col=c("red","purple","black","blue"),pch=c(16,16,17,17), horiz=T)
title(main="Cultivar locations distribution", size =20, cex.main=2,line=-6)
View(Senes_HI)
plot(Senes_HI$d_perc_rf,Senes_HI$HTeCS,ylab="HI",xlab="Harvest dead leaves (%) Maize rainfed",col=ifelse(Senes_HI$Sret==1,"black","red"))
plot(Senes_HI$d_perc_rf[Senes_HI$Sret==0,],Senes_HI$HTeCS[Senes_HI$Sret==0,],ylab="HI",xlab="Harvest dead leaves (%) Maize rainfed",col="red")
plot(Senes_HI$d_perc_rf[Senes_HI$Sret==0,],Senes_HI$HTeCS[Senes_HI$Sret==0,],ylab="HI",xlab="Harvest dead leaves (%) Maize rainfed",col="red")
plot(Senes_HI$d_perc_rf[Senes_HI$Sret==0,],Senes_HI$HTeCS[Senes_HI$Sret==0,],ylab="HI",xlab="Dead leaves in Maize (%)",col="red")
test=[Senes_HI$Sret==0,]
test=Senes_HI$HTeCS[Senes_HI$Sret==0,]
test=Senes_HI[Senes_HI$Sret==0,]
View(test)
plot(test$d_perc_rf,test$HTeCS,ylab="HI",xlab="Dead leaves in Maize (%)",col="red")
dev.new()
par(mfrow=c(2,1),omi=c(0.25,0,0,0),mai=c(0,0,0,0))
plot(test$d_perc_rf,test$HTeCS,ylab="HI",xlab="Dead leaves in Maize (%)",col="red")
par(mfrow=c(1,1),omi=c(0.25,0.25,0.25,0.25),mai=c(0,0,0,0))
plot(test$d_perc_rf,test$HTeCS,ylab="HI",xlab="Dead leaves in Maize (%)",col="red")
par(mfrow=c(1,1),omi=c(1,0.25,1,0.25),mai=c(0,0,0,0))
plot(test$d_perc_rf,test$HTeCS,ylab="HI",xlab="Dead leaves in Maize (%)",col="red")
par(mfrow=c(1,1),omi=c(0.25,1,1,0.25),mai=c(0,0,0,0))
plot(test$d_perc_rf,test$HTeCS,ylab="HI",xlab="Dead leaves in Maize (%)",col="red")
par(mfrow=c(1,1),omi=c(1,0.25,1,0.25),mai=c(0,0,0,0))
plot(test$d_perc_rf,test$HTeCS,ylab="HI",xlab="Dead leaves in Maize (%)",col="red")
par(mfrow=c(1,1),omi=c(1,1,0.25,0.25),mai=c(0,0,0,0))
plot(test$d_perc_rf,test$HTeCS,ylab="HI",xlab="Dead leaves in Maize (%)",col="red")
plot(test$d_perc_rf,test$HTeCS,ylab="HI",xlab="Dead leaves in Maize (%)",col="red",ylab="HI",xlab="Harvest dead leaves (%) Maize irrigated")
plot(test$d_perc_rf,test$HTeCS,ylab="HI",xlab="Dead leaves in Maize (%)",col="red")
plot(test$d_perc_rf,test$HTeCS,ylab="HI",xlab="Dead leaves in Maize (%)",col="red")
title(ylab="HI",xlab="Dead leaves in Maize (%)", line=0, cex.lab=1.2)
plot(test$d_perc_rf,test$HTeCS,col="red")
title(ylab="HI",xlab="Dead leaves in Maize (%)", line=0, cex.lab=0)
